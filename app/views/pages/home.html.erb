<h5>Your location:</h5>

<%= form_tag root_path, method: "GET" do |f| %>
  <%= text_field_tag :address, "", id: "address-input", placeholder: "Enter your address" %>
  <%= submit_tag "submit" %>
<% end %>

<%= form_with url: root_path, method: "GET", remote: true, id: "hidden_form" do |f| %>
  <%= text_field_tag :latitude, nil, id: "lat", class: "hidden" %>
  <%= text_field_tag :longitude, nil, id: "long", class: "hidden" %>
  <%= submit_tag "submit", class: "hidden" %>
<% end %>


<div class="slidecontainer">
  <h5>Distance Radius: <span id="demo"></span> km</h5>
  <input type="range" min="1" max="30" value="15" class="slider" id="myRange">
</div>

<h5 class="feature-header">Not in the mood for:</h5>
<button class="btn btn-primary" id="button-randomeal" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
  Toggle Categories
</button>
<div class="collapse" id="collapseExample">
  <div class="card card-body" id="categories-div">
    Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident.
  </div>
</div>



<script>
  function success(position) {
    const hiddenForm = document.getElementById("hidden_form");

    document.getElementById("lat").value = position.coords.latitude;
    document.getElementById("long").value = position.coords.longitude;

    Rails.fire(hiddenForm, 'submit');
  }

  <% unless params[:latitude].present? %>
    navigator.geolocation.getCurrentPosition(success);
  <% end %>
</script>
